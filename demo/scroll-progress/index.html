<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		.progress{
			position:fixed;
		    top:0;
		    left:0;
		    height:3px;
		    background-color:#ffaaaa;
		}
		body{
			height:4000px;
		}
</style>
</head>
<body>
	<div class="progress"></div>
<script>
(function(){
	var h = window.innerHeight;
	var bodyHeight = document.body.getBoundingClientRect().height;
	var dh = bodyHeight - h;

	window.addEventListener('scroll',function(){
		window.requestAnimationFrame(function(){
			var percent = Math.max(0,Math.min(1, window.pageYOffset / dh));
			document.querySelector('.progress').style.width = percent * 100 + '%';
		})
	},false);
})()

window.requestAnimationFrame = (function(){
	return window.requestAnimationFrame ||
			window.webkitRequestAnimationFrame ||
			window.mozRequestAnimationFrame ||
			window.oRequestAnimationFrame ||
			window.msRequestAnimationFrame ||
			function(callback){
				window.setTimeout(callback,1000/60)
			}
})();
</script>
	
</body>
</html>